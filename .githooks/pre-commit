#!/bin/sh

VERSION_FILE="src/binwalk/core/version.py"

# Check that the auto-generated version.py file is not commited by accident
if [ -f "$VERSION_FILE" ]; then
	(git diff --cached --name-status|grep "$VERSION_FILE")&&(cat "$VERSION_FILE"|grep "# This file has been auto-generated")
	retVal=$?
	if [ $retVal -eq 0 ]; then
		echo "You have an autogenerated $VERSION_FILE in your git repository, reset it to the original for the commit to pass"
		exit 1
	fi
fi
